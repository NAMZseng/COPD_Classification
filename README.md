# Chronic Obstructive Pulmonary Disease(COPD) Classification

---

## 1 数据集划分

合作医院的数据集共有468例病人的CT扫描数据，按照7：3的比例，将前327例的所有图片做为train_valid_set，后141例的所有图片做为test_set。

在train_valid_set中，train_set与valid_set同样以病例为单位，按train_set：valid_set等于6：1划分。为使得train_set与valid_set中的各个COPD等级的数据量也相对均匀，先对train_valid_set中的各个COPD等级的数据进行6：1划分，最后再汇总成最终的train_set与valid_set。

最终，train_set：valid_set：test_set 为 6：1：3。

下表为train_set、valid_set、test_set 中4个COPD等级各自所含的数据量。

|           | 0               | 1               | 2               | 3               | total             |
| --------- | --------------- | --------------- | --------------- | --------------- | ----------------- |
| train_set | 76例，共43694张 | 65例，共40550张 | 75例，共43510张 | 64例，共40944张 | 280例，共168698张 |
| valid_set | 13例，共7705张  | 11例，共6981张  | 12例，共7672张  | 11例，共6924张  | 47例，共29282张   |
| test_set  | 41例，共23940张 | 33例，共21141张 | 35例，共22283张 | 32例，共20478张 | 141例，共87842张  |

## 2 Test_Set中病例COPD等级的预测

DenseNet网络模型的训练与测试，均以每张图片为单位，对病例的每张CT图像预测出4个COPD等级的概率。

对于每例测试病例，先将其所有CT图像在4个COPD等级上的预计结果分别进行求和取平均，得到每例病例在4个COPD等级上的平均概率，取数值最大的做为最终的COPD预测等级。

## 3 训练及测试结果汇总

### 3.1 训练参数

| **数据量** | **train: valid: test** | **Batch size** | **Input size** | **epochs** | **Drop_rate** |
|---------| ---------------------- | -------------- | -------------- | ---------- | ------------- |
| 468例    | 6：1：3                | 20             | 512*512        | 50         | 0.5           |

### 3.2 结果汇总

